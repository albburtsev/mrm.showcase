/**
 * mrm.showcase -- Mail.Ru Maps traffic showcase
 * @author Alexander Burtsev, http://burtsev.me, 2014
 * @license MIT
 */
jQuery(function(a){"use strict";var b=a(".js-map");a.ajaxSetup({dataType:"json",cache:!1});var c=mrm.map(b.get(0));c.removeLayer(c.__layerSchema),c.removeControl(c.copyrightControl),c.removeControl(c.logoControl),L.tileLayer("https://a.tiles.mapbox.com/v3/{mapid}/{z}/{x}/{y}.png",{mapid:"examples.map-9ijuk24y"}).addTo(c),a.get("static/js/config.json",function(a){"undefined"!=typeof showcase&&showcase.init(a,c)}),window.map=c});var showcase=function(){return{init:function(a,b){this.config=a,this.map=b;for(var c in a)for(var d,e=a[c],f=e.directions,g=f.length;g--;){d=f[g];var h=this;$.ajax("http://maps.mail.ru/mroutes",{key:c,data:{wtype:1,points:d.points.join(",")},success:function(a){h.addPolyline(this.key,a)}})}},invertCoords:function(a){for(var b,c=0,d=[];c<a.length;c++){b=a[c];for(var e,f=0;f<b.length;f++)e=b[f],d.push([e[1],e[0]])}return d},addPolyline:function(a,b){var c=this.config[a];c.polyline||(c.polyline=mrm.polyline(this.invertCoords(b.points),{weight:10,opacity:1,lineCap:"round",lineJoin:"bevel",className:"path inactive"}).addTo(map),setTimeout(function(){$(".path.inactive").each(function(){var a=$(this);a.attr("class",a.attr("class").replace("inactive",""))})},1))}}}();